{
  "metadata": {
    "timestamp_utc": "2026-02-19T23:59:37.223784Z",
    "python": "3.12.10 (tags/v3.12.10:0cc8128, Apr  8 2025, 12:21:36) [MSC v.1943 64 bit (AMD64)]",
    "platform": "Windows-11-10.0.26100-SP0",
    "git_commit": null,
    "config": {
      "run": {
        "model_id": "google/gemma-2-2b",
        "device": "cuda",
        "dtype": "bfloat16",
        "batch_size": 4,
        "max_length": 1024,
        "seed": 0,
        "layers": [
          12,
          16,
          20,
          24
        ],
        "sae_release": "gemma-scope-2b-pt-res-canonical",
        "sae_id_template": "layer_{L}/width_16k/canonical",
        "topk": 64,
        "delta_thresh": null,
        "edge_tau": 0.1,
        "bootstrap_B": 2000,
        "perm_N": 10000,
        "fdr_q": 0.05,
        "input_dir": "data/raw/agora",
        "processed_dir": "data/processed",
        "results_dir": "results",
        "logs_dir": "logs",
        "prompt_config": "configs/prompt_templates.yaml"
      },
      "args": {
        "config": "configs/run.yaml",
        "layer": 24,
        "innov_jsonl": "data/processed/dinnov_test.jsonl",
        "selection_tag": "train_k32_cap",
        "topk_safe_json": "results/polarization/layer24_train_topk_safe.json",
        "delta_csv": "results/polarization/layer24_train_delta.csv",
        "features_npz": "results/polarization/layer24_train_features.npz",
        "k": 32,
        "alphas": "0.2,0.4,0.6,0.8,1,1.2,1.4,1.5",
        "modes": "cap",
        "max_samples": 200,
        "sae_npz": null,
        "bootstrap_B": null,
        "perm_N": null,
        "seed": null
      }
    }
  },
  "layer": 24,
  "selection_tag": "train_k32_cap",
  "k": 32,
  "alphas": [
    0.2,
    0.4,
    0.6,
    0.8,
    1.0,
    1.2,
    1.4,
    1.5
  ],
  "modes": [
    "cap"
  ],
  "safe_feature_ids": [
    6711,
    245,
    11139,
    4773,
    14371,
    5081,
    7016,
    5946,
    14448,
    11529,
    16043,
    11008,
    108,
    261,
    13528,
    7344,
    12575,
    3923,
    1388,
    15053,
    748,
    3973,
    13404,
    14162,
    7515,
    3606,
    468,
    12976,
    2299,
    9063,
    11691,
    15851
  ],
  "random_feature_ids": [
    15309,
    10414,
    4542,
    1233,
    272,
    10347,
    9166,
    4413,
    15888,
    13868,
    9926,
    672,
    12527,
    6455,
    8898,
    5036,
    14936,
    44,
    14041,
    13356,
    553,
    10982,
    11951,
    13304,
    10623,
    8242,
    2868,
    2879,
    11939,
    13909,
    9079,
    8360
  ],
  "neutral_feature_ids": [
    2968,
    5306,
    5307,
    5308,
    858,
    10745,
    10741,
    15385,
    854,
    10737,
    10732,
    5317,
    10742,
    10778,
    5301,
    7850,
    856,
    5304,
    5303,
    5282,
    10837,
    5244,
    15374,
    15376,
    871,
    10810,
    10828,
    10777,
    10824,
    5253,
    10818,
    7855
  ],
  "summary_rows": [
    {
      "mode": "cap",
      "alpha": 0.2,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.008510764883915521,
        0.002003958832996131
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.3517265625,
        0.21453125
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008049039606703445,
        -0.0006599517184076832
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.2,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008382100489566306,
        0.002138659579592746
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.2011171875,
        0.3550156249999999
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008049039606703445,
        -0.0006599517184076832
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.2,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": 0.003657196850566521,
      "ci95_delta_prob_inc": [
        -0.003910593676176601,
        0.010318424090116428
      ],
      "mean_delta_logprob_inc": -6.21015625,
      "ci95_delta_logprob_inc": [
        -6.68473046875,
        -5.76328125
      ],
      "mean_delta_mass": -0.000730711953505363,
      "ci95_delta_mass": [
        -0.0008066143941577834,
        -0.0006616289871696424
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.4,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.009014826190894066,
        0.0022711801180785437
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.34765625,
        0.2122031249999999
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008059295992134138,
        -0.0006580751877045259
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.4,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008879356582467975,
        0.002411896978173045
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.2017578125,
        0.3614296874999999
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008059295992134138,
        -0.0006580751877045259
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.4,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": -0.00043380842245629574,
      "ci95_delta_prob_inc": [
        -0.007518905379604002,
        0.005043996180008045
      ],
      "mean_delta_logprob_inc": -3.63390625,
      "ci95_delta_logprob_inc": [
        -4.0234609375,
        -3.2324414062500004
      ],
      "mean_delta_mass": -0.0007307045755442232,
      "ci95_delta_mass": [
        -0.0008077588438102339,
        -0.000659757111265435
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.6,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.00865516549945844,
        0.001973509358645758
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.345203125,
        0.22687890624999998
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008055758511181921,
        -0.0006642478664871306
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.6,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008517575474970748,
        0.0021206133563239577
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.1926640625,
        0.3703828124999996
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008055758511181921,
        -0.0006642478664871306
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.6,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": -0.001592336373117305,
      "ci95_delta_prob_inc": [
        -0.008216888625951005,
        0.003014711453346626
      ],
      "mean_delta_logprob_inc": -1.74984375,
      "ci95_delta_logprob_inc": [
        -2.07473046875,
        -1.4128085937500001
      ],
      "mean_delta_mass": -0.000730621002294356,
      "ci95_delta_mass": [
        -0.0008072284924746782,
        -0.0006659552504279418
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.8,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.008702296905759764,
        0.0021708620420039615
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.32940234375,
        0.21848828124999972
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008038883291883393,
        -0.0006622910167789087
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.8,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008578964080607597,
        0.002310329220784168
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.18532812499999998,
        0.36188671874999995
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008038883291883393,
        -0.0006622910167789087
      ]
    },
    {
      "mode": "cap",
      "alpha": 0.8,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": -0.002257840013422107,
      "ci95_delta_prob_inc": [
        -0.00879132050920677,
        0.0022093706206276556
      ],
      "mean_delta_logprob_inc": -0.65796875,
      "ci95_delta_logprob_inc": [
        -0.9406328125000001,
        -0.37358984375000004
      ],
      "mean_delta_mass": -0.0007301814062520861,
      "ci95_delta_mass": [
        -0.0008052171071176417,
        -0.0006635102577856742
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.0,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.00833922323656569,
        0.0021015160452870683
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.335953125,
        0.20268749999999983
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008022468958515675,
        -0.0006615443234331906
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.0,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008168759601298297,
        0.002242033446650716
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.1861015625,
        0.3440703125
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008022468958515675,
        -0.0006615443234331906
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.0,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": -0.0022200526022424466,
      "ci95_delta_prob_inc": [
        -0.008368304474738091,
        0.0021613042696791438
      ],
      "mean_delta_logprob_inc": -0.18796875,
      "ci95_delta_logprob_inc": [
        -0.466265625,
        0.08079296874999993
      ],
      "mean_delta_mass": -0.0007290002517402173,
      "ci95_delta_mass": [
        -0.0008022552403854206,
        -0.0006615568168926984
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.2,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.008520990960582217,
        0.002053326965734642
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.3398828125,
        0.20004296874999977
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008047589184716344,
        -0.0006592505503213034
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.2,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008393181532872026,
        0.0021909757326429814
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.188484375,
        0.3486093749999999
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008047589184716344,
        -0.0006592505503213034
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.2,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": -0.002266718272004079,
      "ci95_delta_prob_inc": [
        -0.008549837361570075,
        0.002026941835665257
      ],
      "mean_delta_logprob_inc": -0.11328125,
      "ci95_delta_logprob_inc": [
        -0.38625390625,
        0.15031640624999998
      ],
      "mean_delta_mass": -0.0007289760978892446,
      "ci95_delta_mass": [
        -0.0008047583568841219,
        -0.0006592495891964063
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.4,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.00866718194551816,
        0.002036933082621398
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.32735546875,
        0.21454296874999995
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008054332514293492,
        -0.0006590770842740312
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.4,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008543071272027424,
        0.002167726859635533
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.17141796875,
        0.3494296874999997
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008054332514293492,
        -0.0006590770842740312
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.4,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": -0.0022359942740910067,
      "ci95_delta_prob_inc": [
        -0.008670490001167135,
        0.0020356764420013528
      ],
      "mean_delta_logprob_inc": -0.08359375,
      "ci95_delta_logprob_inc": [
        -0.34471484375,
        0.19266796874999995
      ],
      "mean_delta_mass": -0.0007289768429473043,
      "ci95_delta_mass": [
        -0.0008054331210441888,
        -0.0006590769538888709
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.5,
      "condition": "neutral",
      "n": 200,
      "mean_delta_prob_inc": -0.0022341275190008274,
      "ci95_delta_prob_inc": [
        -0.008794810743300517,
        0.001962387705504634
      ],
      "mean_delta_logprob_inc": -0.06203125,
      "ci95_delta_logprob_inc": [
        -0.34001171875,
        0.20469531249999995
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008060841137776151,
        -0.000660636197659187
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.5,
      "condition": "random",
      "n": 200,
      "mean_delta_prob_inc": -0.002101908967343963,
      "ci95_delta_prob_inc": [
        -0.008630390411461587,
        0.002107019400781873
      ],
      "mean_delta_logprob_inc": 0.08328125,
      "ci95_delta_logprob_inc": [
        -0.1926640625,
        0.3539179687499999
      ],
      "mean_delta_mass": -0.0007289769733324646,
      "ci95_delta_mass": [
        -0.0008060841137776151,
        -0.000660636197659187
      ]
    },
    {
      "mode": "cap",
      "alpha": 1.5,
      "condition": "safe",
      "n": 200,
      "mean_delta_prob_inc": -0.002240785862284307,
      "ci95_delta_prob_inc": [
        -0.00879760984542534,
        0.001957106020690874
      ],
      "mean_delta_logprob_inc": -0.07890625,
      "ci95_delta_logprob_inc": [
        -0.35316015625,
        0.1887656249999999
      ],
      "mean_delta_mass": -0.0007289768429473043,
      "ci95_delta_mass": [
        -0.0008060839866520837,
        -0.000660636194399558
      ]
    }
  ],
  "paired_tests_primary_metric": [
    {
      "mode": "cap",
      "alpha": 0.2,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": 0.005759105817910484,
      "ci95": [
        0.0024619671294085262,
        0.009640357048638047
      ],
      "perm_p": 9.999000099990002e-05
    },
    {
      "mode": "cap",
      "alpha": 0.2,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": 0.005891324369567348,
      "ci95": [
        0.002630497678318151,
        0.009787001313813255
      ],
      "perm_p": 9.999000099990002e-05
    },
    {
      "mode": "cap",
      "alpha": 0.4,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": 0.0016681005448876678,
      "ci95": [
        0.0003209843949985381,
        0.0033601148274929418
      ],
      "perm_p": 0.0211978802119788
    },
    {
      "mode": "cap",
      "alpha": 0.4,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": 0.0018003190965445322,
      "ci95": [
        0.0004625051070997748,
        0.003476339265560193
      ],
      "perm_p": 0.009499050094990502
    },
    {
      "mode": "cap",
      "alpha": 0.6,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": 0.0005095725942266581,
      "ci95": [
        -0.0001210805622515718,
        0.0012393537852972017
      ],
      "perm_p": 0.15258474152584742
    },
    {
      "mode": "cap",
      "alpha": 0.6,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": 0.0006417911458835226,
      "ci95": [
        3.8313444071693436e-05,
        0.0013608222685159888
      ],
      "perm_p": 0.058694130586941305
    },
    {
      "mode": "cap",
      "alpha": 0.8,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": -0.00015593104607814441,
      "ci95": [
        -0.0003982388574520704,
        0.0001139924243491691
      ],
      "perm_p": 0.24587541245875413
    },
    {
      "mode": "cap",
      "alpha": 0.8,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": -2.371249442128001e-05,
      "ci95": [
        -0.0002602205687821585,
        0.0002339687926819301
      ],
      "perm_p": 0.8591140885911409
    },
    {
      "mode": "cap",
      "alpha": 1.0,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": -0.00011814363489848377,
      "ci95": [
        -0.00024138601844046843,
        5.723736289231949e-05
      ],
      "perm_p": 0.0888911108889111
    },
    {
      "mode": "cap",
      "alpha": 1.0,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": 1.4074916758380646e-05,
      "ci95": [
        -9.407244902199179e-05,
        0.00018639653512200424
      ],
      "perm_p": 0.975002499750025
    },
    {
      "mode": "cap",
      "alpha": 1.2,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": -0.00016480930466011606,
      "ci95": [
        -0.00023375051492638386,
        -0.00010545129969137583
      ],
      "perm_p": 9.999000099990002e-05
    },
    {
      "mode": "cap",
      "alpha": 1.2,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": -3.2590753003251635e-05,
      "ci95": [
        -6.454412780267725e-05,
        -6.431168632423518e-06
      ],
      "perm_p": 0.012798720127987202
    },
    {
      "mode": "cap",
      "alpha": 1.4,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": -0.0001340853067470436,
      "ci95": [
        -0.00019507015440316014,
        -8.118471871962574e-05
      ],
      "perm_p": 9.999000099990002e-05
    },
    {
      "mode": "cap",
      "alpha": 1.4,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": -1.8667550901792108e-06,
      "ci95": [
        -1.0935582194954035e-05,
        7.480264687449578e-06
      ],
      "perm_p": 0.6838316168383162
    },
    {
      "mode": "cap",
      "alpha": 1.5,
      "compare": "safe_minus_random",
      "n": 200,
      "mean_delta": -0.0001388768949403434,
      "ci95": [
        -0.00020081841255741096,
        -8.235209760003317e-05
      ],
      "perm_p": 9.999000099990002e-05
    },
    {
      "mode": "cap",
      "alpha": 1.5,
      "compare": "safe_minus_neutral",
      "n": 200,
      "mean_delta": -6.658343283478989e-06,
      "ci95": [
        -1.710218681979798e-05,
        2.3329410920623833e-06
      ],
      "perm_p": 0.20337966203379662
    }
  ],
  "sample_csv": "results\\interference\\clamp_samples_layer24_train_k32_cap.csv"
}